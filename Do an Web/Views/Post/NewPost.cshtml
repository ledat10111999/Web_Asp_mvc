
@{
    ViewBag.Title = "NewPost";
    Layout = "~/Views/Shared/_Layout.cshtml";

}

@model Do_an_Web.Models.uppost
<section class="contentDangTin">

    <div class="container">

        @using (Html.BeginForm("NewPost", "Post", FormMethod.Post, new { id = "PostForm", @enctype = "multipart/form-data" }))
        {
            <h1 class="text-center font-weight-bold">Đăng tin mới</h1>
            @Html.AntiForgeryToken();
            @Html.ValidationSummary(true, "", new {@class = "text-danger" })
            @Html.HiddenFor(i => i.IDuser, new { Value = Session["ID"] })
            <hr>
            <div class="row">
                <div class="col-md-8">
                    <!-- Địa chỉ cho thuê -->
                    <div class="rentAddress">
                        <h3 class="font-weight-bold">Địa chỉ cho thuê</h3>
                        <!-- Chọn vị trí -->
                        <div class="row">
                            <div class="col-md-3 pt-3">
                                <div class="form-group">
                                    @Html.DropDownListFor(m => m.tenTp, ViewBag.province as SelectList, "Chọn tỉnh", new { @class = " form-control w-100" })
                                    @Html.ValidationMessageFor(m => m.tenTp, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="col-md-3 pt-3">
                                <div class="form-group">
                                    @if (ViewBag.District == null)
                                    {
                                        @Html.DropDownListFor(m => m.tenQuan, new SelectList(""), "Chọn quận", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenQuan, "", new { @class = "text-danger" })
                                    }
                                    else
                                    {
                                        @Html.DropDownListFor(m => m.tenQuan, ViewBag.District as SelectList, "Chọn quận", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenQuan, "", new { @class = "text-danger" })
                                    }


                                </div>
                            </div>
                            <div class="col-md-3 pt-3">
                                <div class="form-group">
                                    @if (ViewBag.Ward == null)
                                    {
                                        @Html.DropDownListFor(m => m.tenPhuong, new SelectList(""), "Chọn phường", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenPhuong, "", new { @class = "text-danger" })
                                    }
                                    else
                                    {
                                        @Html.DropDownListFor(m => m.tenPhuong, ViewBag.Ward as SelectList, "Chọn phường", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenPhuong, "", new { @class = "text-danger" })
                                    }

                                </div>
                            </div>
                            <div class="col-md-3 pt-3">
                                <div class="form-group">
                                    @if (ViewBag.Street == null)
                                    {
                                        @Html.DropDownListFor(m => m.tenDuong, new SelectList(""), "Chọn Đường", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenDuong, "", new { @class = "text-danger" })
                                    }
                                    else
                                    {
                                        @Html.DropDownListFor(m => m.tenDuong, ViewBag.Street as SelectList, "Chọn Đường", new { @class = " form-control w-100" })
                                        @Html.ValidationMessageFor(m => m.tenDuong, "", new { @class = "text-danger" })
                                    }


                                </div>
                            </div>


                        </div>

                        <!-- Số nhà -->
                        <label for="address" class="font-weight-bold">Số nhà:</label><br>
                        @Html.TextBoxFor(p => p.soNha, new { id = "address", @class = "form-control w-25" })
                        @Html.ValidationMessageFor(m => m.soNha, "", new { @class = "text-danger" })<br />
                        <!-- Địa chỉ chính xác -->
                        <label for="excelentAddress" class="font-weight-bold" style="margin-top: 20px;">
                            Địa chỉ chính
                            xác
                        </label><br>
                        @Html.TextBoxFor(p => p.DiaChiChinhXac, new { id = "excelentAddress", @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.DiaChiChinhXac, "", new { @class = "text-danger" })

                    </div>

                    <!-- Thông tin mô tả -->
                    <div class="rentInfo" style="margin-top: 50px;">
                        <h3 class="font-weight-bold">Thông tin mô tả</h3>
                        <div class="row">
                            <div class="col-md-6 pt-3">
                                <div class="form-group">
                                    @Html.DropDownListFor(p => p.ThongTinMoTa, ViewBag.ThongTinMoTa as SelectList, "Thông tin mô tả", new { @class = "form-control w-100" })
                                    @Html.ValidationMessageFor(m => m.ThongTinMoTa, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>

                        <!-- Tiêu đề -->
                        <label for="infoTitle" class="font-weight-bold">Tiêu đề:</label><br>
                        @Html.TextBoxFor(p => p.TieuDe, new { id = "infoTitle", @class = "form-control w-75" })
                        @Html.ValidationMessageFor(m => m.TieuDe, "", new { @class = "text-danger" })

                        <!-- Nội dung mô tả -->
                        <div class="infoContent" style="margin-top: 20px;">
                            <label for="infoTitle" class="font-weight-bold">Nội dung mô tả:</label><br>
                            @Html.TextAreaFor(p => p.NoiDung, new { id = "infoContent", @rows = "5", @class = "form-control" })
                            @Html.ValidationMessageFor(m => m.NoiDung, "", new { @class = "text-danger" })
                        </div>

                        <!-- Số điện thoại -->
                        <label for="phoneNumber" class="font-weight-bold" style="margin-top: 20px">
                            Số điện
                            thoại:
                        </label><br>

                        @Html.TextBoxFor(p => p.SDT, new { @class = "form-control w-75", id = "phoneNumber" })
                        @Html.ValidationMessageFor(m => m.SDT, "", new { @class = "text-danger" })
                        <!-- Giá cho thuê -->
                        <label for="infoTitle" class="font-weight-bold" style="margin-top: 20px;">
                            Giá cho
                            thuê:
                        </label><br>
                                <div class="input-group mb-3 w-50">
                                    @Html.TextBoxFor(p => p.Gia, new { id = "infoTitle", @class = "form-control" })

                                    <div class="input-group-append">
                                        <span class="input-group-text">Đồng</span>
                                    </div>
                                    <br />
                                    @Html.ValidationMessageFor(m => m.Gia, "", new { @class = "text-danger" })
                                </div>

                        <!-- Diện tích -->
                        <label for="infoAcreage" class="font-weight-bold">Diện tích:</label><br>
                        <div class="input-group mb-3 w-25">

                            @Html.TextBoxFor(p => p.DienTich, new { @type = "number", id = "infoTitle", @class = "form-control" })
                             
                            <div class="input-group-append">
                                <span class="input-group-text">m2</span>
                            </div> <br />
                            @Html.ValidationMessageFor(m => m.DienTich, "", new { @class = "text-danger" })
                        </div>

                        <!-- Đối tượng cho thuê -->
                        <div class="row">
                            <div class="col-md-4 pt-3">
                                <div class="form-group">
                                    @Html.DropDownListFor(p => p.DoiTuongChoThue, new SelectList(Enum.GetValues(typeof(Do_an_Web.Models.DoiTuong))), "Đối tượng cho thuê", new { @class = "form-control w-100" })
                                    @Html.ValidationMessageFor(m => m.DoiTuongChoThue, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="rentImage" style="margin-top: 50px;">
                        <h3 class="font-weight-bold">Hình ảnh</h3>
                        <p>Cập nhật hình ảnh rõ ràng sẽ cho thuê nhanh hơn</p>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Upload</span>
                            </div>
                            <div class="custom-file">
                                @Html.TextBoxFor(p => p.image, new { @multiple=true , @type = "file", @class="custom-file-input" ,id="inputGroupFile" ,@name="uploadImg"})
                                @Html.ValidationMessageFor(m=> m.image,"" ,new { @class = "text-danger"})
                                <label for="inputGroupFile" class="custom-file-label">Choose file</label>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="addImg">

                    </div>
                    <button type="submit" class="btn btn-primary btn-block font-weight-bold"
                            style="margin-top: 50px;">
                        Hoàn
                        thành
                    </button>
                </div>

                <!-- Lưu ý đăng tin -->
                <div class="col-md-4">
                    <div class="rentAlert">
                        <div class="alert alert-warning">
                            <h5>Lưu ý khi đăng tin</h5>
                            <p>
                                1. Nội dung phải viết bằng tiếng Việt có dấu <br>
                                2. Tiêu đề tin không dài quá 100 kí tự <br>
                                3. Các bạn nên điền đầy đủ thông tin vào các mục để tin đăng có hiệu quả hơn. <br>
                                4. Để tăng độ tin cậy và tin rao được nhiều người quan tâm hơn, hãy sửa vị trí tin
                                rao
                                của
                                bạn trên bản đồ bằng cách kéo icon tới đúng vị trí của tin rao. <br>
                                5. Tin đăng có hình ảnh rõ ràng sẽ được xem và gọi gấp nhiều lần so với tin rao
                                không có
                                ảnh. Hãy đăng ảnh để được giao dịch nhanh chóng! <br>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</section>
@Scripts.Render("~/Scripts/newpost.js")
<!-- preview img -->
<script>
$(document).ready(function () {
    $('#inputGroupFile').on('change', function () {
      var files = $(this)[0].files;
      for (var i = 0; i < files.length; i++) {
        var file = files[i];
        var fileReader = new FileReader();
        fileReader.onload = (function (fileParams) {
          return function (event) {

              var str = `<div class="col-md-4 pt-3">
              <img class="img-thumbnail js-file-image" id="_${i}" style="width: 100%; height: 100%">
              </div>`;
            $('#addImg').append(str);
            var imageSrc = event.target.result;
            var fileName = fileParams.name;
            var fileSize = fileParams.size;
            // $('.js-file-name').last().text(fileName);
            // $('.js-file-size').last().text(fileSize);
            $('.js-file-image').last().attr('src', imageSrc);
          };
        })(file);
        fileReader.readAsDataURL(file);

      }
    });
  });

</script>


